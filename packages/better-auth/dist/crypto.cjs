"use strict";var i=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var l=Object.getOwnPropertyNames;var w=Object.prototype.hasOwnProperty;var B=(r,t)=>{for(var e in t)i(r,e,{get:t[e],enumerable:!0})},k=(r,t,e,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of l(t))!w.call(r,n)&&n!==e&&i(r,n,{get:()=>t[n],enumerable:!(o=h(t,n))||o.enumerable});return r};var S=r=>k(i({},"__esModule",{value:!0}),r);var H={};B(H,{constantTimeEqual:()=>y,generateRandomString:()=>T,hashPassword:()=>U,symmetricDecrypt:()=>D,symmetricEncrypt:()=>E,verifyPassword:()=>N});module.exports=S(H);var p=require("@better-auth/utils/hash"),f=require("@noble/ciphers/chacha"),s=require("@noble/ciphers/utils"),d=require("@noble/ciphers/webcrypto");function y(r,t){let e=new Uint8Array(r),o=new Uint8Array(t);if(e.length!==o.length)return!1;let n=0;for(let c=0;c<e.length;c++)n|=e[c]^o[c];return n===0}var g=require("@noble/hashes/scrypt"),x=require("uncrypto"),m=require("@better-auth/utils/hex"),a={N:16384,r:16,p:1,dkLen:64};async function u(r,t){return await(0,g.scryptAsync)(r.normalize("NFKC"),t,{N:a.N,p:a.p,r:a.r,dkLen:a.dkLen,maxmem:128*a.N*a.r*2})}var U=async r=>{let t=m.hex.encode((0,x.getRandomValues)(new Uint8Array(16))),e=await u(r,t);return`${t}:${m.hex.encode(e)}`},N=async({hash:r,password:t})=>{let[e,o]=r.split(":"),n=await u(t,e);return y(n,new Uint8Array(Buffer.from(o,"hex")))};var A=require("@better-auth/utils/random"),T=(0,A.createRandomStringGenerator)("a-z","0-9","A-Z","-_");var E=async({key:r,data:t})=>{let e=await(0,p.createHash)("SHA-256").digest(r),o=(0,s.utf8ToBytes)(t),n=(0,d.managedNonce)(f.xchacha20poly1305)(new Uint8Array(e));return(0,s.bytesToHex)(n.encrypt(o))},D=async({key:r,data:t})=>{let e=await(0,p.createHash)("SHA-256").digest(r),o=(0,s.hexToBytes)(t),n=(0,d.managedNonce)(f.xchacha20poly1305)(new Uint8Array(e));return new TextDecoder().decode(n.decrypt(o))};0&&(module.exports={constantTimeEqual,generateRandomString,hashPassword,symmetricDecrypt,symmetricEncrypt,verifyPassword});
