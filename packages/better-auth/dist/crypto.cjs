"use strict";var y=Object.defineProperty;var l=Object.getOwnPropertyDescriptor;var w=Object.getOwnPropertyNames;var B=Object.prototype.hasOwnProperty;var a=(r,t)=>y(r,"name",{value:t,configurable:!0});var k=(r,t)=>{for(var e in t)y(r,e,{get:t[e],enumerable:!0})},S=(r,t,e,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of w(t))!B.call(r,n)&&n!==e&&y(r,n,{get:()=>t[n],enumerable:!(o=l(t,n))||o.enumerable});return r};var U=r=>S(y({},"__esModule",{value:!0}),r);var O={};k(O,{constantTimeEqual:()=>m,generateRandomString:()=>E,hashPassword:()=>N,symmetricDecrypt:()=>H,symmetricEncrypt:()=>D,verifyPassword:()=>T});module.exports=U(O);var f=require("@better-auth/utils/hash"),d=require("@noble/ciphers/chacha"),c=require("@noble/ciphers/utils"),g=require("@noble/ciphers/webcrypto");function m(r,t){let e=new Uint8Array(r),o=new Uint8Array(t);if(e.length!==o.length)return!1;let n=0;for(let i=0;i<e.length;i++)n|=e[i]^o[i];return n===0}a(m,"constantTimeEqual");var x=require("@noble/hashes/scrypt"),u=require("uncrypto"),p=require("@better-auth/utils/hex");var s={N:16384,r:16,p:1,dkLen:64};async function A(r,t){return await(0,x.scryptAsync)(r.normalize("NFKC"),t,{N:s.N,p:s.p,r:s.r,dkLen:s.dkLen,maxmem:128*s.N*s.r*2})}a(A,"generateKey");var N=a(async r=>{let t=p.hex.encode((0,u.getRandomValues)(new Uint8Array(16))),e=await A(r,t);return`${t}:${p.hex.encode(e)}`},"hashPassword"),T=a(async({hash:r,password:t})=>{let[e,o]=r.split(":"),n=await A(t,e);return m(n,new Uint8Array(Buffer.from(o,"hex")))},"verifyPassword");var h=require("@better-auth/utils/random"),E=(0,h.createRandomStringGenerator)("a-z","0-9","A-Z","-_");var D=a(async({key:r,data:t})=>{let e=await(0,f.createHash)("SHA-256").digest(r),o=(0,c.utf8ToBytes)(t),n=(0,g.managedNonce)(d.xchacha20poly1305)(new Uint8Array(e));return(0,c.bytesToHex)(n.encrypt(o))},"symmetricEncrypt"),H=a(async({key:r,data:t})=>{let e=await(0,f.createHash)("SHA-256").digest(r),o=(0,c.hexToBytes)(t),n=(0,g.managedNonce)(d.xchacha20poly1305)(new Uint8Array(e));return new TextDecoder().decode(n.decrypt(o))},"symmetricDecrypt");0&&(module.exports={constantTimeEqual,generateRandomString,hashPassword,symmetricDecrypt,symmetricEncrypt,verifyPassword});
