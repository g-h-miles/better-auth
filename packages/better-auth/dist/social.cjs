"use strict";var v=Object.defineProperty;var me=Object.getOwnPropertyDescriptor;var fe=Object.getOwnPropertyNames;var ge=Object.prototype.hasOwnProperty;var n=(e,t)=>v(e,"name",{value:t,configurable:!0});var he=(e,t)=>{for(var r in t)v(e,r,{get:t[r],enumerable:!0})},be=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of fe(t))!ge.call(e,o)&&o!==r&&v(e,o,{get:()=>t[o],enumerable:!(i=me(t,o))||i.enumerable});return e};var ye=e=>be(v({},"__esModule",{value:!0}),e);var De={};he(De,{SocialProviderListEnum:()=>Be,apple:()=>P,discord:()=>A,dropbox:()=>$,facebook:()=>R,getApplePublicKey:()=>Q,github:()=>I,gitlab:()=>D,google:()=>T,linkedin:()=>C,microsoft:()=>O,reddit:()=>G,socialProviderList:()=>ue,socialProviders:()=>le,spotify:()=>z,twitch:()=>E,twitter:()=>S});module.exports=ye(De);var q=require("@better-fetch/fetch"),W=require("better-call"),g=require("jose");var N=n((e,t="ms")=>new Date(Date.now()+(t==="sec"?e*1e3:e)),"getDate");var j=require("@better-auth/utils/hash"),M=require("@better-auth/utils/base64");async function F(e){let t=await(0,j.createHash)("SHA-256").digest(e);return M.base64Url.encode(new Uint8Array(t),{padding:!1})}n(F,"generateCodeChallenge");function x(e){return{tokenType:e.token_type,accessToken:e.access_token,refreshToken:e.refresh_token,accessTokenExpiresAt:e.expires_in?N(e.expires_in,"sec"):void 0,scopes:e?.scope?typeof e.scope=="string"?e.scope.split(" "):e.scope:[],idToken:e.id_token}}n(x,"getOAuth2Tokens");async function p({id:e,options:t,authorizationEndpoint:r,state:i,codeVerifier:o,scopes:a,claims:s,redirectURI:c,duration:u}){let d=new URL(r);if(d.searchParams.set("response_type","code"),d.searchParams.set("client_id",t.clientId),d.searchParams.set("state",i),d.searchParams.set("scope",a.join(" ")),d.searchParams.set("redirect_uri",t.redirectURI||c),o){let f=await F(o);d.searchParams.set("code_challenge_method","S256"),d.searchParams.set("code_challenge",f)}if(s){let f=s.reduce((h,pe)=>(h[pe]=null,h),{});d.searchParams.set("claims",JSON.stringify({id_token:{email:null,email_verified:null,...f}}))}return u&&d.searchParams.set("duration",u),d}n(p,"createAuthorizationURL");var H=require("@better-fetch/fetch");var _e=require("jose");async function l({code:e,codeVerifier:t,redirectURI:r,options:i,tokenEndpoint:o,authentication:a}){let s=new URLSearchParams,c={"content-type":"application/x-www-form-urlencoded",accept:"application/json","user-agent":"better-auth"};if(s.set("grant_type","authorization_code"),s.set("code",e),t&&s.set("code_verifier",t),s.set("redirect_uri",r),a==="basic"){let h=btoa(`${i.clientId}:${i.clientSecret}`);c.authorization=`Basic ${h}`}else s.set("client_id",i.clientId),s.set("client_secret",i.clientSecret);let{data:u,error:d}=await(0,H.betterFetch)(o,{method:"POST",body:s,headers:c});if(d)throw d;return x(u)}n(l,"validateAuthorizationCode");var Le=require("zod"),Te=require("better-call");var w=Object.create(null),_=n(e=>globalThis.process?.env||globalThis.Deno?.env.toObject()||globalThis.__env__||(e?w:globalThis),"_getEnv"),K=new Proxy(w,{get(e,t){return _()[t]??w[t]},has(e,t){let r=_();return t in r||t in w},set(e,t,r){let i=_(!0);return i[t]=r,!0},deleteProperty(e,t){if(!t)return!1;let r=_(!0);return delete r[t],!0},ownKeys(){let e=_(!0);return Object.keys(e)}});function ve(e){return e?e!=="false":!1}n(ve,"toBoolean");var xe=typeof process<"u"&&process.env&&process.env.NODE_ENV||"";var Xe=xe==="test"||ve(K.TEST);var b=class extends Error{static{n(this,"BetterAuthError")}constructor(t,r){super(t),this.name="BetterAuthError",this.message=t,this.cause=r,this.stack=""}};var Re=require("@better-auth/utils/hash"),ke=require("@noble/ciphers/chacha"),U=require("@noble/ciphers/utils"),Ie=require("@noble/ciphers/webcrypto");var we=require("@noble/hashes/scrypt"),Ue=require("uncrypto"),Pe=require("@better-auth/utils/hex");var J=require("@better-auth/utils/random"),Ae=(0,J.createRandomStringGenerator)("a-z","0-9","A-Z","-_");var P=n(e=>{let t="https://appleid.apple.com/auth/token";return{id:"apple",name:"Apple",createAuthorizationURL({state:r,scopes:i,redirectURI:o}){let a=i||["email","name"];return e.scope&&a.push(...e.scope),new URL(`https://appleid.apple.com/auth/authorize?client_id=${e.clientId}&response_type=code&redirect_uri=${e.redirectURI||o}&scope=${a.join(" ")}&state=${r}&response_mode=form_post`)},validateAuthorizationCode:n(async({code:r,codeVerifier:i,redirectURI:o})=>l({code:r,codeVerifier:i,redirectURI:e.redirectURI||o,options:e,tokenEndpoint:t}),"validateAuthorizationCode"),async verifyIdToken(r,i){if(e.disableIdTokenSignIn)return!1;if(e.verifyIdToken)return e.verifyIdToken(r,i);let o=(0,g.decodeProtectedHeader)(r),{kid:a,alg:s}=o;if(!a||!s)return!1;let c=await Q(a),{payload:u}=await(0,g.jwtVerify)(r,c,{algorithms:[s],issuer:"https://appleid.apple.com",audience:e.appBundleIdentifier||e.clientId,maxTokenAge:"1h"});return["email_verified","is_private_email"].forEach(d=>{u[d]!==void 0&&(u[d]=!!u[d])}),i&&u.nonce!==i?!1:!!u},async getUserInfo(r){if(e.getUserInfo)return e.getUserInfo(r);if(!r.idToken)return null;let i=(0,g.decodeJwt)(r.idToken);if(!i)return null;let o=i.user?`${i.user.name.firstName} ${i.user.name.lastName}`:i.email,a=await e.mapProfileToUser?.(i);return{user:{id:i.sub,name:o,emailVerified:!1,email:i.email,...a},data:i}}}},"apple"),Q=n(async e=>{let t="https://appleid.apple.com",r="/auth/keys",{data:i}=await(0,q.betterFetch)(`${t}${r}`);if(!i?.keys)throw new W.APIError("BAD_REQUEST",{message:"Keys not found"});let o=i.keys.find(a=>a.kid===e);if(!o)throw new Error(`JWK with kid ${e} not found`);return await(0,g.importJWK)(o,o.alg)},"getApplePublicKey");var X=require("@better-fetch/fetch");var A=n(e=>({id:"discord",name:"Discord",createAuthorizationURL({state:t,scopes:r,redirectURI:i}){let o=r||["identify","email"];return e.scope&&o.push(...e.scope),new URL(`https://discord.com/api/oauth2/authorize?scope=${o.join("+")}&response_type=code&client_id=${e.clientId}&redirect_uri=${encodeURIComponent(e.redirectURI||i)}&state=${t}&prompt=${e.prompt||"none"}`)},validateAuthorizationCode:n(async({code:t,redirectURI:r})=>l({code:t,redirectURI:e.redirectURI||r,options:e,tokenEndpoint:"https://discord.com/api/oauth2/token"}),"validateAuthorizationCode"),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);let{data:r,error:i}=await(0,X.betterFetch)("https://discord.com/api/users/@me",{headers:{authorization:`Bearer ${t.accessToken}`}});if(i)return null;if(r.avatar===null){let a=r.discriminator==="0"?Number(BigInt(r.id)>>BigInt(22))%6:parseInt(r.discriminator)%5;r.image_url=`https://cdn.discordapp.com/embed/avatars/${a}.png`}else{let a=r.avatar.startsWith("a_")?"gif":"png";r.image_url=`https://cdn.discordapp.com/avatars/${r.id}/${r.avatar}.${a}`}let o=await e.mapProfileToUser?.(r);return{user:{id:r.id,name:r.display_name||r.username||"",email:r.email,emailVerified:r.verified,image:r.image_url,...o},data:r}}}),"discord");var Z=require("@better-fetch/fetch");var R=n(e=>({id:"facebook",name:"Facebook",async createAuthorizationURL({state:t,scopes:r,redirectURI:i}){let o=r||["email","public_profile"];return e.scope&&o.push(...e.scope),await p({id:"facebook",options:e,authorizationEndpoint:"https://www.facebook.com/v21.0/dialog/oauth",scopes:o,state:t,redirectURI:i})},validateAuthorizationCode:n(async({code:t,redirectURI:r})=>l({code:t,redirectURI:e.redirectURI||r,options:e,tokenEndpoint:"https://graph.facebook.com/oauth/access_token"}),"validateAuthorizationCode"),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);let{data:r,error:i}=await(0,Z.betterFetch)("https://graph.facebook.com/me?fields=id,name,email,picture",{auth:{type:"Bearer",token:t.accessToken}});if(i)return null;let o=await e.mapProfileToUser?.(r);return{user:{id:r.id,name:r.name,email:r.email,image:r.picture.data.url,emailVerified:r.email_verified,...o},data:r}}}),"facebook");var k=require("@better-fetch/fetch");var I=n(e=>{let t="https://github.com/login/oauth/access_token";return{id:"github",name:"GitHub",createAuthorizationURL({state:r,scopes:i,codeVerifier:o,redirectURI:a}){let s=i||["user:email"];return e.scope&&s.push(...e.scope),p({id:"github",options:e,authorizationEndpoint:"https://github.com/login/oauth/authorize",scopes:s,state:r,redirectURI:a})},validateAuthorizationCode:n(async({code:r,redirectURI:i})=>l({code:r,redirectURI:e.redirectURI||i,options:e,tokenEndpoint:t}),"validateAuthorizationCode"),async getUserInfo(r){if(e.getUserInfo)return e.getUserInfo(r);let{data:i,error:o}=await(0,k.betterFetch)("https://api.github.com/user",{headers:{"User-Agent":"better-auth",authorization:`Bearer ${r.accessToken}`}});if(o)return null;let a=!1,{data:s}=await(0,k.betterFetch)("https://api.github.com/user/emails",{headers:{authorization:`Bearer ${r.accessToken}`,"User-Agent":"better-auth"}});s&&(i.email=(s.find(u=>u.primary)??s[0])?.email,a=s.find(u=>u.email===i.email)?.verified??!1);let c=await e.mapProfileToUser?.(i);return{user:{id:i.id.toString(),name:i.name||i.login,email:i.email,image:i.avatar_url,emailVerified:a,...c},data:i}}}},"github");var L=["info","success","warn","error","debug"];function Oe(e,t){return L.indexOf(t)<=L.indexOf(e)}n(Oe,"shouldPublishLog");var m={reset:"\x1B[0m",bright:"\x1B[1m",dim:"\x1B[2m",underscore:"\x1B[4m",blink:"\x1B[5m",reverse:"\x1B[7m",hidden:"\x1B[8m",fg:{black:"\x1B[30m",red:"\x1B[31m",green:"\x1B[32m",yellow:"\x1B[33m",blue:"\x1B[34m",magenta:"\x1B[35m",cyan:"\x1B[36m",white:"\x1B[37m"},bg:{black:"\x1B[40m",red:"\x1B[41m",green:"\x1B[42m",yellow:"\x1B[43m",blue:"\x1B[44m",magenta:"\x1B[45m",cyan:"\x1B[46m",white:"\x1B[47m"}},ze={info:m.fg.blue,success:m.fg.green,warn:m.fg.yellow,error:m.fg.red,debug:m.fg.magenta},Ee=n((e,t)=>{let r=new Date().toISOString();return`${m.dim}${r}${m.reset} ${ze[e]}${e.toUpperCase()}${m.reset} ${m.bright}Better Auth${m.reset} ${t}`},"formatMessage"),Se=n(e=>{let t=e?.disabled!==!0,r=e?.level??"error",i=n((o,a,s=[])=>{if(!t||!Oe(r,o))return;let c=Ee(o,a);if(!e||typeof e.log!="function"){o==="error"?console.error(c,...s):o==="warn"?console.warn(c,...s):console.log(c,...s);return}e.log(o==="success"?"info":o,c,...s)},"LogFunc");return Object.fromEntries(L.map(o=>[o,(...[a,...s])=>i(o,a,s)]))},"createLogger"),y=Se();var Y=require("@better-fetch/fetch"),ee=require("jose");var T=n(e=>({id:"google",name:"Google",async createAuthorizationURL({state:t,scopes:r,codeVerifier:i,redirectURI:o}){if(!e.clientId||!e.clientSecret)throw y.error("Client Id and Client Secret is required for Google. Make sure to provide them in the options."),new b("CLIENT_ID_AND_SECRET_REQUIRED");if(!i)throw new b("codeVerifier is required for Google");let a=r||["email","profile","openid"];e.scope&&a.push(...e.scope);let s=await p({id:"google",options:e,authorizationEndpoint:"https://accounts.google.com/o/oauth2/auth",scopes:a,state:t,codeVerifier:i,redirectURI:o});return e.accessType&&s.searchParams.set("access_type",e.accessType),e.prompt&&s.searchParams.set("prompt",e.prompt),s},validateAuthorizationCode:n(async({code:t,codeVerifier:r,redirectURI:i})=>l({code:t,codeVerifier:r,redirectURI:e.redirectURI||i,options:e,tokenEndpoint:"https://oauth2.googleapis.com/token"}),"validateAuthorizationCode"),async verifyIdToken(t,r){if(e.disableIdTokenSignIn)return!1;if(e.verifyIdToken)return e.verifyIdToken(t,r);let i=`https://www.googleapis.com/oauth2/v3/tokeninfo?id_token=${t}`,{data:o}=await(0,Y.betterFetch)(i);return o?o.aud===e.clientId&&o.iss==="https://accounts.google.com":!1},async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);if(!t.idToken)return null;let r=(0,ee.decodeJwt)(t.idToken),i=await e.mapProfileToUser?.(r);return{user:{id:r.sub,name:r.name,email:r.email,image:r.picture,emailVerified:r.email_verified,...i},data:r}}}),"google");var re=require("@better-fetch/fetch");var te=require("jose");var O=n(e=>{let t=e.tenantId||"common",r=`https://login.microsoftonline.com/${t}/oauth2/v2.0/authorize`,i=`https://login.microsoftonline.com/${t}/oauth2/v2.0/token`;return{id:"microsoft",name:"Microsoft EntraID",createAuthorizationURL(o){let a=o.scopes||["openid","profile","email","User.Read"];return e.scope&&a.push(...e.scope),p({id:"microsoft",options:e,authorizationEndpoint:r,state:o.state,codeVerifier:o.codeVerifier,scopes:a,redirectURI:o.redirectURI})},validateAuthorizationCode({code:o,codeVerifier:a,redirectURI:s}){return l({code:o,codeVerifier:a,redirectURI:e.redirectURI||s,options:e,tokenEndpoint:i})},async getUserInfo(o){if(e.getUserInfo)return e.getUserInfo(o);if(!o.idToken)return null;let a=(0,te.decodeJwt)(o.idToken),s=e.profilePhotoSize||48;await(0,re.betterFetch)(`https://graph.microsoft.com/v1.0/me/photos/${s}x${s}/$value`,{headers:{Authorization:`Bearer ${o.accessToken}`},async onResponse(u){if(!(e.disableProfilePhoto||!u.response.ok))try{let f=await u.response.clone().arrayBuffer(),h=Buffer.from(f).toString("base64");a.picture=`data:image/jpeg;base64, ${h}`}catch(d){y.error(d&&typeof d=="object"&&"name"in d?d.name:"",d)}}});let c=await e.mapProfileToUser?.(a);return{user:{id:a.sub,name:a.name,email:a.email,image:a.picture,emailVerified:!0,...c},data:a}}}},"microsoft");var ie=require("@better-fetch/fetch");var z=n(e=>({id:"spotify",name:"Spotify",createAuthorizationURL({state:t,scopes:r,codeVerifier:i,redirectURI:o}){let a=r||["user-read-email"];return e.scope&&a.push(...e.scope),p({id:"spotify",options:e,authorizationEndpoint:"https://accounts.spotify.com/authorize",scopes:a,state:t,codeVerifier:i,redirectURI:o})},validateAuthorizationCode:n(async({code:t,codeVerifier:r,redirectURI:i})=>l({code:t,codeVerifier:r,redirectURI:e.redirectURI||i,options:e,tokenEndpoint:"https://accounts.spotify.com/api/token"}),"validateAuthorizationCode"),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);let{data:r,error:i}=await(0,ie.betterFetch)("https://api.spotify.com/v1/me",{method:"GET",headers:{Authorization:`Bearer ${t.accessToken}`}});if(i)return null;let o=await e.mapProfileToUser?.(r);return{user:{id:r.id,name:r.display_name,email:r.email,image:r.images[0]?.url,emailVerified:!1,...o},data:r}}}),"spotify");var $e=require("@better-auth/utils/random");var oe=require("jose");var E=n(e=>({id:"twitch",name:"Twitch",createAuthorizationURL({state:t,scopes:r,redirectURI:i}){let o=r||["user:read:email","openid"];return e.scope&&o.push(...e.scope),p({id:"twitch",redirectURI:i,options:e,authorizationEndpoint:"https://id.twitch.tv/oauth2/authorize",scopes:o,state:t,claims:e.claims||["email","email_verified","preferred_username","picture"]})},validateAuthorizationCode:n(async({code:t,redirectURI:r})=>l({code:t,redirectURI:e.redirectURI||r,options:e,tokenEndpoint:"https://id.twitch.tv/oauth2/token"}),"validateAuthorizationCode"),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);let r=t.idToken;if(!r)return y.error("No idToken found in token"),null;let i=(0,oe.decodeJwt)(r),o=await e.mapProfileToUser?.(i);return{user:{id:i.sub,name:i.preferred_username,email:i.email,image:i.picture,emailVerified:!1,...o},data:i}}}),"twitch");var ne=require("@better-fetch/fetch");var S=n(e=>({id:"twitter",name:"Twitter",createAuthorizationURL(t){let r=t.scopes||["users.read","tweet.read","offline.access"];return e.scope&&r.push(...e.scope),p({id:"twitter",options:e,authorizationEndpoint:"https://x.com/i/oauth2/authorize",scopes:r,state:t.state,codeVerifier:t.codeVerifier,redirectURI:t.redirectURI})},validateAuthorizationCode:n(async({code:t,codeVerifier:r,redirectURI:i})=>l({code:t,codeVerifier:r,authentication:"basic",redirectURI:e.redirectURI||i,options:e,tokenEndpoint:"https://api.x.com/2/oauth2/token"}),"validateAuthorizationCode"),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);let{data:r,error:i}=await(0,ne.betterFetch)("https://api.x.com/2/users/me?user.fields=profile_image_url",{method:"GET",headers:{Authorization:`Bearer ${t.accessToken}`}});if(i)return null;let o=await e.mapProfileToUser?.(r);return{user:{id:r.data.id,name:r.data.name,email:r.data.username||null,image:r.data.profile_image_url,emailVerified:r.data.verified||!1,...o},data:r}}}),"twitter");var ae=require("@better-fetch/fetch");var $=n(e=>{let t="https://api.dropboxapi.com/oauth2/token";return{id:"dropbox",name:"Dropbox",createAuthorizationURL:n(async({state:r,scopes:i,codeVerifier:o,redirectURI:a})=>{let s=i||["account_info.read"];return e.scope&&s.push(...e.scope),await p({id:"dropbox",options:e,authorizationEndpoint:"https://www.dropbox.com/oauth2/authorize",scopes:s,state:r,redirectURI:a,codeVerifier:o})},"createAuthorizationURL"),validateAuthorizationCode:n(async({code:r,codeVerifier:i,redirectURI:o})=>await l({code:r,codeVerifier:i,redirectURI:e.redirectURI||o,options:e,tokenEndpoint:t}),"validateAuthorizationCode"),async getUserInfo(r){if(e.getUserInfo)return e.getUserInfo(r);let{data:i,error:o}=await(0,ae.betterFetch)("https://api.dropboxapi.com/2/users/get_current_account",{method:"POST",headers:{Authorization:`Bearer ${r.accessToken}`}});if(o)return null;let a=await e.mapProfileToUser?.(i);return{user:{id:i.account_id,name:i.name?.display_name,email:i.email,emailVerified:i.email_verified||!1,image:i.profile_photo_url,...a},data:i}}}},"dropbox");var se=require("@better-fetch/fetch");var C=n(e=>{let t="https://www.linkedin.com/oauth/v2/authorization",r="https://www.linkedin.com/oauth/v2/accessToken";return{id:"linkedin",name:"Linkedin",createAuthorizationURL:n(async({state:i,scopes:o,redirectURI:a})=>{let s=o||["profile","email","openid"];return e.scope&&s.push(...e.scope),await p({id:"linkedin",options:e,authorizationEndpoint:t,scopes:s,state:i,redirectURI:a})},"createAuthorizationURL"),validateAuthorizationCode:n(async({code:i,redirectURI:o})=>await l({code:i,redirectURI:e.redirectURI||o,options:e,tokenEndpoint:r}),"validateAuthorizationCode"),async getUserInfo(i){let{data:o,error:a}=await(0,se.betterFetch)("https://api.linkedin.com/v2/userinfo",{method:"GET",headers:{Authorization:`Bearer ${i.accessToken}`}});if(a)return null;let s=await e.mapProfileToUser?.(o);return{user:{id:o.sub,name:o.name,email:o.email,emailVerified:o.email_verified||!1,image:o.picture,...s},data:o}}}},"linkedin");var ce=require("@better-fetch/fetch");var B=n((e="")=>e.split("://").map(t=>t.replace(/\/{2,}/g,"/")).join("://"),"cleanDoubleSlashes"),Ce=n(e=>{let t=e||"https://gitlab.com";return{authorizationEndpoint:B(`${t}/oauth/authorize`),tokenEndpoint:B(`${t}/oauth/token`),userinfoEndpoint:B(`${t}/api/v4/user`)}},"issuerToEndpoints"),D=n(e=>{let{authorizationEndpoint:t,tokenEndpoint:r,userinfoEndpoint:i}=Ce(e.issuer),o="gitlab";return{id:o,name:"Gitlab",createAuthorizationURL:n(async({state:s,scopes:c,codeVerifier:u,redirectURI:d})=>{let f=c||["read_user"];return e.scope&&f.push(...e.scope),await p({id:o,options:e,authorizationEndpoint:t,scopes:f,state:s,redirectURI:d,codeVerifier:u})},"createAuthorizationURL"),validateAuthorizationCode:n(async({code:s,redirectURI:c,codeVerifier:u})=>l({code:s,redirectURI:e.redirectURI||c,options:e,codeVerifier:u,tokenEndpoint:r}),"validateAuthorizationCode"),async getUserInfo(s){if(e.getUserInfo)return e.getUserInfo(s);let{data:c,error:u}=await(0,ce.betterFetch)(i,{headers:{authorization:`Bearer ${s.accessToken}`}});if(u||c.state!=="active"||c.locked)return null;let d=await e.mapProfileToUser?.(c);return{user:{id:c.id.toString(),name:c.name??c.username,email:c.email,image:c.avatar_url,emailVerified:!0,...d},data:c}}}},"gitlab");var V=require("@better-fetch/fetch");var G=n(e=>({id:"reddit",name:"Reddit",createAuthorizationURL({state:t,scopes:r,redirectURI:i}){let o=r||["identity"];return e.scope&&o.push(...e.scope),p({id:"reddit",options:e,authorizationEndpoint:"https://www.reddit.com/api/v1/authorize",scopes:o,state:t,redirectURI:i,duration:e.duration})},validateAuthorizationCode:n(async({code:t,redirectURI:r})=>{let i=new URLSearchParams({grant_type:"authorization_code",code:t,redirect_uri:e.redirectURI||r}),o={"content-type":"application/x-www-form-urlencoded",accept:"text/plain","user-agent":"better-auth",Authorization:`Basic ${Buffer.from(`${e.clientId}:${e.clientSecret}`).toString("base64")}`},{data:a,error:s}=await(0,V.betterFetch)("https://www.reddit.com/api/v1/access_token",{method:"POST",headers:o,body:i.toString()});if(s)throw s;return x(a)},"validateAuthorizationCode"),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);let{data:r,error:i}=await(0,V.betterFetch)("https://oauth.reddit.com/api/v1/me",{headers:{Authorization:`Bearer ${t.accessToken}`,"User-Agent":"better-auth"}});if(i)return null;let o=await e.mapProfileToUser?.(r);return{user:{id:r.id,name:r.name,email:r.oauth_client_id,emailVerified:r.has_verified_email,image:r.icon_img?.split("?")[0],...o},data:r}}}),"reddit");var de=require("zod"),le={apple:P,discord:A,facebook:R,github:I,microsoft:O,google:T,spotify:z,twitch:E,twitter:S,dropbox:$,linkedin:C,gitlab:D,reddit:G},ue=Object.keys(le),Be=de.z.enum(ue,{description:"OAuth2 provider to use"});0&&(module.exports={SocialProviderListEnum,apple,discord,dropbox,facebook,getApplePublicKey,github,gitlab,google,linkedin,microsoft,reddit,socialProviderList,socialProviders,spotify,twitch,twitter});
