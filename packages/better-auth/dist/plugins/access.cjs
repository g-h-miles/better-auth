"use strict";var o=Object.defineProperty;var x=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var A=Object.prototype.hasOwnProperty;var u=(e,t)=>o(e,"name",{value:t,configurable:!0});var R=(e,t)=>{for(var r in t)o(e,r,{get:t[r],enumerable:!0})},T=(e,t,r,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of y(t))!A.call(e,n)&&n!==r&&o(e,n,{get:()=>t[n],enumerable:!(s=x(t,n))||s.enumerable});return e};var b=e=>T(o({},"__esModule",{value:!0}),e);var z={};R(z,{adminAc:()=>l,createAccessControl:()=>m,defaultAc:()=>a,defaultRoles:()=>g,defaultStatements:()=>d,memberAc:()=>f,ownerAc:()=>S,role:()=>p});module.exports=b(z);function m(e){let t=e;return{newRole(r){return p(r)}}}u(m,"createAccessControl");function p(e){return{statements:e,authorize(t,r){for(let[s,n]of Object.entries(t)){let c=e[s];return c?(r==="OR"?n.some(i=>c.includes(i)):n.every(i=>c.includes(i)))?{success:!0}:{success:!1,error:`Unauthorized to access resource "${s}"`}:{success:!1,error:`You are not allowed to access resource: ${s}`}}return{success:!1,error:"Not authorized"}}}}u(p,"role");var d={organization:["update","delete"],member:["create","update","delete"],invitation:["create","cancel"]},a=m(d),l=a.newRole({organization:["update"],invitation:["create","cancel"],member:["create","update","delete"]}),S=a.newRole({organization:["update","delete"],member:["create","update","delete"],invitation:["create","cancel"]}),f=a.newRole({organization:[],member:[],invitation:[]}),g={admin:l,owner:S,member:f};0&&(module.exports={adminAc,createAccessControl,defaultAc,defaultRoles,defaultStatements,memberAc,ownerAc,role});
