var m=Object.defineProperty;var a=(e,t)=>m(e,"name",{value:t,configurable:!0});function u(e){let t=e;return{newRole(r){return p(r)}}}a(u,"createAccessControl");function p(e){return{statements:e,authorize(t,r){for(let[n,i]of Object.entries(t)){let s=e[n];return s?(r==="OR"?i.some(o=>s.includes(o)):i.every(o=>s.includes(o)))?{success:!0}:{success:!1,error:`Unauthorized to access resource "${n}"`}:{success:!1,error:`You are not allowed to access resource: ${n}`}}return{success:!1,error:"Not authorized"}}}}a(p,"role");var d={organization:["update","delete"],member:["create","update","delete"],invitation:["create","cancel"]},c=u(d),l=c.newRole({organization:["update"],invitation:["create","cancel"],member:["create","update","delete"]}),S=c.newRole({organization:["update","delete"],member:["create","update","delete"],invitation:["create","cancel"]}),f=c.newRole({organization:[],member:[],invitation:[]}),b={admin:l,owner:S,member:f};export{l as adminAc,u as createAccessControl,c as defaultAc,b as defaultRoles,d as defaultStatements,f as memberAc,S as ownerAc,p as role};
