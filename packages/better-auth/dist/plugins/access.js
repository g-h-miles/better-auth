function i(e){let a=e;return{newRole(t){return u(t)}}}function u(e){return{statements:e,authorize(a,t){for(let[r,c]of Object.entries(a)){let n=e[r];return n?(t==="OR"?c.some(s=>n.includes(s)):c.every(s=>n.includes(s)))?{success:!0}:{success:!1,error:`Unauthorized to access resource "${r}"`}:{success:!1,error:`You are not allowed to access resource: ${r}`}}return{success:!1,error:"Not authorized"}}}}var m={organization:["update","delete"],member:["create","update","delete"],invitation:["create","cancel"]},o=i(m),p=o.newRole({organization:["update"],invitation:["create","cancel"],member:["create","update","delete"]}),d=o.newRole({organization:["update","delete"],member:["create","update","delete"],invitation:["create","cancel"]}),l=o.newRole({organization:[],member:[],invitation:[]}),y={admin:p,owner:d,member:l};export{p as adminAc,i as createAccessControl,o as defaultAc,y as defaultRoles,m as defaultStatements,l as memberAc,d as ownerAc,u as role};
