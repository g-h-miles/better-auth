"use strict";var l=Object.defineProperty;var M=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var S=Object.prototype.hasOwnProperty;var s=(e,t)=>l(e,"name",{value:t,configurable:!0});var w=(e,t)=>{for(var o in t)l(e,o,{get:t[o],enumerable:!0})},O=(e,t,o,c)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of x(t))!S.call(e,r)&&r!==o&&l(e,r,{get:()=>t[r],enumerable:!(c=M(t,r))||c.enumerable});return e};var D=e=>O(l({},"__esModule",{value:!0}),e);var H={};w(H,{nextCookies:()=>_,toNextJsHandler:()=>E});module.exports=D(H);var T=require("next/headers");var p=Object.create(null),u=s(e=>globalThis.process?.env||globalThis.Deno?.env.toObject()||globalThis.__env__||(e?p:globalThis),"_getEnv"),A=new Proxy(p,{get(e,t){return u()[t]??p[t]},has(e,t){let o=u();return t in o||t in p},set(e,t,o){let c=u(!0);return c[t]=o,!0},deleteProperty(e,t){if(!t)return!1;let o=u(!0);return delete o[t],!0},ownKeys(){let e=u(!0);return Object.keys(e)}});function j(e){return e?e!=="false":!1}s(j,"toBoolean");var $=typeof process<"u"&&process.env&&process.env.NODE_ENV||"";var q=$==="test"||j(A.TEST);var v=require("@better-auth/utils/base64");var R=require("@better-auth/utils/hmac");function k(e){let t=new Map;return e.split(", ").forEach(c=>{let r=c.split(";").map(f=>f.trim()),[i,...m]=r,[d,...g]=i.split("="),h=g.join("=");if(!d||h===void 0)return;let a={value:h};m.forEach(f=>{let[C,...y]=f.split("="),n=y.join("="),b=C.trim().toLowerCase();switch(b){case"max-age":a["max-age"]=n?parseInt(n.trim(),10):void 0;break;case"expires":a.expires=n?new Date(n.trim()):void 0;break;case"domain":a.domain=n?n.trim():void 0;break;case"path":a.path=n?n.trim():void 0;break;case"secure":a.secure=!0;break;case"httponly":a.httponly=!0;break;case"samesite":a.samesite=n?n.trim().toLowerCase():void 0;break;default:a[b]=n?n.trim():!0;break}}),t.set(d,a)}),t}s(k,"parseSetCookieHeader");function E(e){let t=s(async o=>"handler"in e?e.handler(o):e(o),"handler");return{GET:t,POST:t}}s(E,"toNextJsHandler");var _=s(()=>({id:"next-cookies",hooks:{after:[{matcher(e){return!0},handler:s(async e=>{let t=e.responseHeader;if(!("_flag"in e&&e._flag==="router")&&t instanceof Headers){let o=t?.get("set-cookie");if(!o)return;let c=k(o),r=await(0,T.cookies)();c.forEach((i,m)=>{if(!m)return;let d={sameSite:i.samesite,secure:i.secure,maxAge:i["max-age"],httpOnly:i.httponly,domain:i.domain,path:i.path};try{r.set(m,decodeURIComponent(i.value),d)}catch{}});return}},"handler")}]}}),"nextCookies");0&&(module.exports={nextCookies,toNextJsHandler});
